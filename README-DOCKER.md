# OpenVPN Docker Server - –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è OpenVPN —Å–µ—Ä–≤–µ—Ä–∞ –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –Ω–∞ —á–∏—Å—Ç–æ–º Ubuntu —Å–µ—Ä–≤–µ—Ä–µ.

üöÄ **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ "–ø–æ–¥ –∫–ª—é—á"** - –æ–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ: Docker, OpenVPN, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏, –∫–ª–∏–µ–Ω—Ç–æ–≤.

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚úÖ **–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —á–∏—Å—Ç–æ–º Ubuntu –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚úÖ **Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å—Ä–µ–¥–∞
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP** - –Ω–∏–∫–∞–∫–∏—Ö —Ä—É—á–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- ‚úÖ **–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è** - ECDSA, SHA512, AES-256-GCM
- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ, —ç–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - TLS-Crypt, CRL, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∏—Ñ—Ä—ã
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ª–æ–≥–∏, —Å—Ç–∞—Ç—É—Å, health checks
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –µ–¥–∏–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–û–°**: Ubuntu 18.04+ (–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ 20.04, 22.04)
- **–ü—Ä–∞–≤–∞**: root –¥–æ—Å—Ç—É–ø (sudo)
- **–°–µ—Ç—å**: –æ—Ç–∫—Ä—ã—Ç—ã–π –ø–æ—Ä—Ç 1194/UDP
- **–†–µ—Å—É—Ä—Å—ã**: –º–∏–Ω–∏–º—É–º 1GB RAM, 2GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- **–ò–Ω—Ç–µ—Ä–Ω–µ—Ç**: –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ Docker –∏ –ø–∞–∫–µ—Ç–æ–≤

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

```bash
# –°–∫–∞—á–∏–≤–∞–µ–º –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã
wget https://raw.githubusercontent.com/your-repo/openvpn-docker/main/install.sh
wget https://raw.githubusercontent.com/your-repo/openvpn-docker/main/Dockerfile
wget https://raw.githubusercontent.com/your-repo/openvpn-docker/main/docker-compose.yml
wget https://raw.githubusercontent.com/your-repo/openvpn-docker/main/entrypoint.sh
wget https://raw.githubusercontent.com/your-repo/openvpn-docker/main/client-manager.sh

chmod +x install.sh entrypoint.sh client-manager.sh
```

### 2. –ó–∞–ø—É—Å–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP –∞–¥—Ä–µ—Å–∞
sudo ./install.sh

# –ò–ª–∏ —É–∫–∞–∑–∞—Ç—å IP –≤—Ä—É—á–Ω—É—é
sudo ./install.sh 1.2.3.4
```

### 3. –ì–æ—Ç–æ–≤–æ! üéâ

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —É –≤–∞—Å –±—É–¥–µ—Ç:
- –ó–∞–ø—É—â–µ–Ω–Ω—ã–π OpenVPN —Å–µ—Ä–≤–µ—Ä –≤ Docker
- –ü–µ—Ä–≤—ã–π –∫–ª–∏–µ–Ω—Ç `client1` —Å –≥–æ—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- –°–∫—Ä–∏–ø—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è `openvpn-manager`
- –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
/opt/openvpn-docker/          # –û—Å–Ω–æ–≤–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
‚îú‚îÄ‚îÄ Dockerfile                # –û–±—Ä–∞–∑ Docker —Å OpenVPN
‚îú‚îÄ‚îÄ docker-compose.yml        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
‚îú‚îÄ‚îÄ entrypoint.sh             # –°–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
‚îú‚îÄ‚îÄ client-configs/           # –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ .ovpn —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ client1.ovpn         # –ü–µ—Ä–≤—ã–π –∫–ª–∏–µ–Ω—Ç
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ client-manager.sh    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏
‚îú‚îÄ‚îÄ data/                    # PKI —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (Docker volume)
‚îî‚îÄ‚îÄ logs/                    # –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ (Docker volume)

/usr/local/bin/
‚îî‚îÄ‚îÄ openvpn-manager          # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–º

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
openvpn-manager status

# –ó–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞/–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
openvpn-manager start
openvpn-manager stop
openvpn-manager restart

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
openvpn-manager logs
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏

```bash
# –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
openvpn-manager client add john

# –£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
openvpn-manager client remove john

# –°–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤
openvpn-manager client list

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ
./client-manager.sh info john

# –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
./client-manager.sh export john ./john.ovpn
```

## üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞

```bash
# –ß–µ—Ä–µ–∑ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
openvpn-manager client add alice

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ client-manager
cd /opt/openvpn-docker
./scripts/client-manager.sh add alice
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∫–ª–∏–µ–Ω—Ç–∞
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è .ovpn –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `/opt/openvpn-docker/client-configs/alice.ovpn`

### –£–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞

```bash
openvpn-manager client remove alice
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∫–ª–∏–µ–Ω—Ç–∞ –æ—Ç–∑—ã–≤–∞–µ—Ç—Å—è (–¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ CRL)
- –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è Certificate Revocation List –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –£–¥–∞–ª—è—é—Ç—Å—è —Ñ–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

```bash
openvpn-manager client list
```

**–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã
- –û—Ç–æ–∑–≤–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
- –°—Ä–æ–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- –õ–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## üì± –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∫–ª–∏–µ–Ω—Ç–æ–≤

### –° —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É

```bash
# SCP
scp root@your-server-ip:/opt/openvpn-docker/client-configs/client1.ovpn .

# –ò–ª–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
ssh root@your-server-ip "cat /opt/openvpn-docker/client-configs/client1.ovpn"
```

### –ü—Ä—è–º–æ–π —ç–∫—Å–ø–æ—Ä—Ç

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /opt/openvpn-docker
./scripts/client-manager.sh export client1 ./client1.ovpn
```

## üñ•Ô∏è –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤

### Windows
1. –°–∫–∞—á–∞–π—Ç–µ [OpenVPN GUI](https://openvpn.net/community-downloads/)
2. –ü–æ–º–µ—Å—Ç–∏—Ç–µ .ovpn —Ñ–∞–π–ª –≤ `C:\Program Files\OpenVPN\config\`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ OpenVPN GUI –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å

### macOS
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Tunnelblick](https://tunnelblick.net/)
2. –î–≤–∞–∂–¥—ã —â–µ–ª–∫–Ω–∏—Ç–µ –ø–æ .ovpn —Ñ–∞–π–ª—É
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### Linux
```bash
# Ubuntu/Debian
sudo apt install openvpn
sudo openvpn --config client1.ovpn

# –ò–ª–∏ –∫–∞–∫ —Å–µ—Ä–≤–∏—Å
sudo cp client1.ovpn /etc/openvpn/client/
sudo systemctl start openvpn-client@client1
```

### Android/iOS
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ OpenVPN Connect –∏–∑ App Store/Google Play
2. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ .ovpn —Ñ–∞–π–ª —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
# –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å
openvpn-manager status

# Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker ps | grep openvpn-server
docker stats openvpn-server

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
openvpn-manager logs
```

### –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```bash
# –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
docker exec openvpn-server cat /var/log/openvpn/status.log

# –ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã
docker exec openvpn-server grep "CLIENT_LIST" /var/log/openvpn/status.log
```

### –°–µ—Ç–µ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
ss -ulnp | grep 1194
netstat -ulnp | grep 1194

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª iptables
iptables -L -n | grep -A5 -B5 tun
iptables -t nat -L -n | grep MASQUERADE

# IP forwarding
sysctl net.ipv4.ip_forward
```

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
docker logs openvpn-server

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
docker exec openvpn-server openvpn --config /etc/openvpn/server/server.conf --test-crypto

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
openvpn-manager restart
```

### –ö–ª–∏–µ–Ω—Ç—ã –Ω–µ –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç–∞
telnet YOUR_SERVER_IP 1194

# –ü—Ä–æ–≤–µ—Ä–∫–∞ UFW/iptables
ufw status
iptables -L -n

# –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS
nslookup YOUR_SERVER_IP
```

### –ù–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ —É –∫–ª–∏–µ–Ω—Ç–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ IP forwarding
sysctl net.ipv4.ip_forward

# –ü—Ä–æ–≤–µ—Ä–∫–∞ NAT –ø—Ä–∞–≤–∏–ª
iptables -t nat -L -n | grep MASQUERADE

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
ip route | grep default
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è**: ECDSA –∫–ª—é—á–∏, SHA512 —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ**: AES-256-GCM –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: TLS-Crypt –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã
- **PKI**: –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∫–ª—é—á–µ–π
- **CRL**: –û—Ç–∑—ã–≤ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ PKI
docker run --rm -v openvpn_data:/data -v $(pwd):/backup ubuntu tar czf /backup/openvpn-pki-backup.tar.gz -C /data .

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
docker run --rm -v openvpn_data:/data -v $(pwd):/backup ubuntu tar xzf /backup/openvpn-pki-backup.tar.gz -C /data
```

## üìö –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã** - —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –û–°, –ø—Ä–∞–≤–∞ root
2. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã** - apt update/upgrade, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
3. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker** - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è
4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–∏** - UFW, iptables, IP forwarding
5. **–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞** - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —Å–∫—Ä–∏–ø—Ç—ã
6. **–°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞** - Docker build —Å OpenVPN –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
7. **–ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** - Docker Compose —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
8. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PKI** - CA, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞, TLS-Crypt –∫–ª—é—á–∏
9. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è client1
10. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤** - openvpn-manager –≤ /usr/local/bin

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|--------------|----------|
| `OPENVPN_SERVER_IP` | auto-detect | –í–Ω–µ—à–Ω–∏–π IP —Å–µ—Ä–≤–µ—Ä–∞ |
| `OPENVPN_PORT` | 1194 | UDP –ø–æ—Ä—Ç OpenVPN |
| `OPENVPN_PROTOCOL` | udp | –ü—Ä–æ—Ç–æ–∫–æ–ª (udp/tcp) |
| `OPENVPN_NETWORK` | 10.8.0.0 | –°–µ—Ç—å VPN |
| `OPENVPN_NETMASK` | 255.255.255.0 | –ú–∞—Å–∫–∞ —Å–µ—Ç–∏ |
| `OPENVPN_DNS1` | 1.1.1.1 | –ü–µ—Ä–≤–∏—á–Ω—ã–π DNS |
| `OPENVPN_DNS2` | 1.0.0.1 | –í—Ç–æ—Ä–∏—á–Ω—ã–π DNS |

### Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- **–û–±—Ä–∞–∑**: Ubuntu 22.04 + OpenVPN + Easy-RSA
- **–ü—Ä–∏–≤–∏–ª–µ–≥–∏–∏**: NET_ADMIN –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ç—å—é
- **–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**: /dev/net/tun –¥–ª—è VPN —Ç—É–Ω–Ω–µ–ª–µ–π
- **Volumes**: –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ PKI –∏ –ª–æ–≥–æ–≤
- **Health Check**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- **Restart Policy**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å–±–æ—è—Ö

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –§–∞–π–ª—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–±–ª–µ–º

```bash
# –õ–æ–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
journalctl -u docker
tail -f /var/log/syslog

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker
docker inspect openvpn-server
docker logs openvpn-server

# –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
ip route
iptables -L -n
ufw status verbose
```

### –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å DNS —Å–µ—Ä–≤–µ—Ä—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤?**
A: –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `OPENVPN_DNS1` –∏ `OPENVPN_DNS2` –≤ `docker-compose.yml`

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TCP –≤–º–µ—Å—Ç–æ UDP?**
A: –î–∞, –∏–∑–º–µ–Ω–∏—Ç–µ `OPENVPN_PROTOCOL=tcp` –∏ –ø–æ—Ä—Ç –≤ `docker-compose.yml`

**Q: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã?**
A: –î–æ–±–∞–≤—å—Ç–µ `push "route 192.168.1.0 255.255.255.0"` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ—Ä–≤–µ—Ä–∞

**Q: –ö–∞–∫ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–∞?**
A: –£–±–µ—Ä–∏—Ç–µ `duplicate-cn` –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ –¥–ª—è –ª—é–±—ã—Ö —Ü–µ–ª–µ–π.

---

**–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è OpenVPN —Å–µ—Ä–≤–µ—Ä–æ–≤**